---
layout: page
# title: "Birds Checklist"
---

<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

<p class="checklist-title" id="birdChecklistTitle">Birds of North America</p>

<!-- Custom tabs -->
<div class="tabs">
  <button data-sheet="https://docs.google.com/spreadsheets/d/e/2PACX-1vTIJ0x6PAfm2a2jW7dxYmhHGNbsbMCOvfYoL1HLh9qVSxD9nZfRUDUcLfjo8gFHq37NM6Ad52r2VL35/pubhtml?gid=1386834576&single=true" class="active">Urban & Wetland</button>
  <button data-sheet="https://docs.google.com/spreadsheets/d/e/2PACX-1vTIJ0x6PAfm2a2jW7dxYmhHGNbsbMCOvfYoL1HLh9qVSxD9nZfRUDUcLfjo8gFHq37NM6Ad52r2VL35/pubhtml?gid=1392521724&single=true">Forest</button>
  <button data-sheet="https://docs.google.com/spreadsheets/d/e/2PACX-1vTIJ0x6PAfm2a2jW7dxYmhHGNbsbMCOvfYoL1HLh9qVSxD9nZfRUDUcLfjo8gFHq37NM6Ad52r2VL35/pubhtml?gid=1996768528&single=true">Sea & Shore</button>
  <button data-sheet="https://docs.google.com/spreadsheets/d/e/2PACX-1vTIJ0x6PAfm2a2jW7dxYmhHGNbsbMCOvfYoL1HLh9qVSxD9nZfRUDUcLfjo8gFHq37NM6Ad52r2VL35/pubhtml?gid=1969026289&single=true">Raptors</button>
</div>

<!-- iframe container -->
<div class="iframe-container">
  <iframe
    id="birdSheet"
    src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTIJ0x6PAfm2a2jW7dxYmhHGNbsbMCOvfYoL1HLh9qVSxD9nZfRUDUcLfjo8gFHq37NM6Ad52r2VL35/pubhtml?gid=1386834576&single=true"
    loading="lazy"
  ></iframe>
</div>

<script>
  const iframe = document.getElementById("birdSheet");

  // Fetch observed count
  async function updateTotalCompleted() {
    try {
      const response = await fetch("https://script.google.com/macros/s/AKfycbxe4NClXq55jbnJaGiQTo_JZZY2337armVG1s7Jh-AuiKBWur-OjrIKXh41HVep3getbQ/exec");
      const total = await response.text();

      const title = document.getElementById("birdChecklistTitle");
      
      // Use innerHTML and wrap the observed count in a styled span
      title.innerHTML = `Birds of North America (<span class="highlight-observed">Species I observed: ${total}</span>)`;
    } catch (error) {
      console.error("Failed to fetch total completed:", error);
    }
  }
  // Call the function
  updateTotalCompleted();

  // Adjust iframe scale and overlay position
  function adjustIframe() {
    const baseWidth = 1100;   
    const baseTopMargin = 30; // desktop margin-top to hide title row

    const w = window.innerWidth;
    const vh = window.visualViewport?.height || window.innerHeight;

    const header = document.querySelector('.header');
    const menuHeight = header ? header.offsetHeight : 120;

    const scale = Math.min(w / baseWidth, 1);
    iframe.style.transform = `scale(${scale})`;

    // proportional negative margin to hide the sheet title row
    iframe.style.marginTop = `${-baseTopMargin * scale}px`;

    const availableHeight = vh - menuHeight;
    const scaledHeight = availableHeight / scale;

    const minHeight = 520; // key fix
    iframe.style.height = Math.max(scaledHeight, minHeight) + "px";
    iframe.parentElement.style.height = Math.max(availableHeight, minHeight) + "px";
  }

  window.addEventListener("load", adjustIframe);
  window.addEventListener("resize", adjustIframe);

  // Tab switching
  document.querySelectorAll('.tabs button').forEach(btn => {
    btn.addEventListener('click', () => {
      // Remove active class from all buttons
      document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Change iframe src to selected sheet URL
      iframe.src = btn.dataset.sheet;
    });
  });
</script>

<style>
.checklist-title {
  font-size: 0.95em;
  font-style: italic;
  font-weight: bold;
  color: #555;
  margin-bottom: 0.3em;
  text-align: left;
}

.highlight-observed {
  color: #26A69A;       /* orange color */
  font-weight: bold;     /* bold text */
  font-style: italic;    /* italic */
}

/* Tabs styling */
.tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 8px;
  flex-wrap: nowrap;      /* keep in one line */
  overflow-x: auto;  /* allow horizontal scroll if too narrow */
}

.tabs > * {
  flex-shrink: 1;    /* allow items to squeeze */
  min-width: 0;      /* enable shrinking below intrinsic width */
}

/* Tab buttons */
.tabs button {
  padding: 4px 10px;
  font-size: 0.85em;
  border: 1px solid #ccc;
  background-color: #f5f5f5;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

/* Hover effect */
.tabs button:hover {
  background-color: #e0f2f1;
  border-color: #26A69A;
  color: #26A69A;
}

/* Active tab */
.tabs button.active {
  background-color: #26A69A;  /* green highlight */
  color: #fff;                /* white text */
  border-color: #26A69A;      /* match background */
  font-weight: bold;
}

/* iframe container */
.iframe-container {
  position: relative;
  width: 100%;
  overflow: hidden;
}

.iframe-container iframe {
  width: 1000px;
  height: 650px;
  border: none;
  transform-origin: top left;
}

</style>